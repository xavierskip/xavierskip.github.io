---
layout: post
title: ç¬¬äºŒå±ŠåŒ—äº¬å¤§å­¦ä¿¡æ¯å®‰å…¨ç»¼åˆèƒ½åŠ›ç«èµ›
tags:
- ctf
---

æ˜¯çš„åˆæœ‰ä¸€ä¸ªCTFæ¯”èµ›å¯ä»¥å‚åŠ äº†ã€‚([ä¸Šä¸€ä¸ªæ¯”èµ›åœ¨æ­¤](/2022-11-06-hackgame/))ã€‚

[åŒ—äº¬å¤§å­¦ä¿¡æ¯å®‰å…¨ç»¼åˆèƒ½åŠ›ç«èµ›ï¼ˆPKU GeekGameï¼‰æ˜¯ä»¥ä¿¡æ¯å®‰å…¨ç›¸å…³çŸ¥è¯†èƒ½åŠ›ä¸ºä¸»çš„å…¥é—¨å‘ç«èµ›ï¼Œæ¯”èµ›ç›®çš„æ˜¯æ™®åŠç½‘ç»œä¸ä¿¡æ¯å®‰å…¨ç›¸å…³çŸ¥è¯†ï¼Œå¹¶é€‰æ‹”éƒ¨åˆ†ä¼˜ç§€åŒå­¦åŠ å…¥åˆ°åŒ—äº¬å¤§å­¦ CTF æˆ˜é˜Ÿã€‚ æœ¬å±Šç«èµ›å°†ç»§ç»­è¿½æ±‚é¢˜ç›®æ–°é¢–æœ‰è¶£ã€éš¾åº¦å…·æœ‰æ¢¯åº¦ï¼Œè®©æ²¡æœ‰ç›¸å…³ç»éªŒçš„æ–°ç”Ÿå’Œå…·æœ‰ä¸€å®šä¸“ä¸šåŸºç¡€çš„å­¦ç”Ÿéƒ½èƒ½äº«å—æ¯”èµ›ï¼Œåœ¨å­¦ä¹ çš„è¿‡ç¨‹ä¸­æœ‰æ‰€æ”¶è·ã€‚](https://geekgame.pku.edu.cn/)

æ˜¯ç¬¬ä¸€æ¬¡å‚åŠ  PKU çš„ GeekGameã€‚ç»“æœä¸Šæ¥ç¬¬ä¸€é“ç­¾åˆ°é¢˜å°±ç»™äº†æˆ‘ä¸€ä¸ªä¸‹é©¬å¨ï¼Œå› ä¸ºä¸€èˆ¬çš„CTFæ¯”èµ›çš„ç­¾åˆ°é¢˜éƒ½æ˜¯ä¸ªwebé¢˜ï¼Œæœ‰æ‰‹å°±å¯è¿‡ï¼Œæ²¡æœ‰ä»€ä¹ˆå¼¯å¼¯ç»•ï¼Œå…¶å®æ˜¯èµ·åˆ°ç»Ÿè®¡çœŸæ­£å‚åŠ æ¯”èµ›äººæ•°çš„ä½œç”¨ã€‚è¿™æ¬¡çš„ç­¾åˆ°é¢˜åˆ°æœ€ååªæœ‰600äººé€šè¿‡äº†ï¼Œä¸ä¸­ç§‘å¤§çš„æ¯”èµ›ç­¾åˆ°é¢˜å®Œæˆäººæ•°æœ‰è¿‘2700äººæ¯”è¾ƒï¼Œæ˜¯å‚ä¸äººå°‘äº†è¿˜æ˜¯éš¾åº¦æé«˜äº†å‘¢ï¼Ÿ

ä¸€ä¸ªæ˜ŸæœŸçš„æ¯”èµ›ç»“æŸäº†ï¼Œæˆ‘è·å¾—äº†æ€»åˆ†545ã€æ€»æ’å141çš„æˆç»©ã€‚çœ‹çš„å‡ºæ¥ç›¸æ¯”è¾ƒä¸­ç§‘å¤§çš„æ¯”èµ›ï¼Œå‚èµ›äººæ•°å°‘å¤šäº†ï¼Œç›¸åº”çš„éš¾åº¦ä¹Ÿæœ‰æ‰€æé«˜ã€‚

![æˆç»©](https://h.xavierskip.com:42049/i/eaf243e6da121f70c41e63a2d05168af597a37ec965798922a4eb499b525816e.png)

å¼€å§‹æˆ‘çœ‹åˆ°æ¯é“é¢˜çš„å®Œæˆæƒ…å†µï¼Œå¯¹è‡ªå·±æœ‰äº†æ·±æ·±çš„æ€€ç–‘ï¼Œæ²¡æœ‰ä¿¡å¿ƒå‘€ï¼Œè¿™äº›é¢˜æˆ‘ä¼°è®¡æ˜¯ä¸€ä¸ªéƒ½åšä¸å‡ºæ¥äº†ã€‚ç»“æœï¼Œè¿˜æ˜¯å‡­å€Ÿè‡ªå·±çš„åŠªåŠ›è¿˜æ˜¯åšå‡ºæ¥äº†å‡ é¢˜ï¼Œç¬¬äºŒé˜¶æ®µç»™äº†æ›´å¤šçš„æç¤ºåï¼Œä¹Ÿæå®šäº†ä¸€é¢˜ã€‚æ•´ä¸ªè¿‡ç¨‹è¿˜æ˜¯æœ‰ä¸€å®šçš„æˆå°±æ„Ÿçš„ã€‚

ä¸‹é¢å°±è®°å½•ä¸€ä¸‹æˆ‘çš„è§£é¢˜è¿‡ç¨‹ï¼š

#### [ç­¾åˆ°](https://geekgame.pku.edu.cn/#/game/prob19)

ä¸‹è½½ä¸‹æ¥ä¸€ä¸ªPDFæ–‡ä»¶ï¼Œè¿™æ˜¯è¦å¹²å•¥ï¼Œæˆ‘è¿˜ç…æœ‰å…¶äº‹çš„æŠŠæ–‡ä»¶ä¸¢è¿›[HxD](https://mh-nexus.de/en/hxd/)é‡Œè§‚å¯Ÿä¸€ç•ªï¼Œæ²¡æœ‰ã€‚ä¸€ä¸ªç­¾åˆ°é¢˜è€Œå·²ï¼Œè¿˜è¦æ€ä¹ˆå¤æ‚å‘¢ï¼Ÿæˆ‘è§‚å¯Ÿåˆ°ç”¨edgeæµè§ˆå™¨æ‰“å¼€pdfæ–‡ä»¶ä¼šæ˜¾ç¤ºâ€œæ­¤æ–‡ä»¶å…·æœ‰å—é™æƒé™ã€‚æ‚¨å¯èƒ½æ— æ³•è®¿é—®æŸäº›åŠŸèƒ½ã€‚â€æ˜¯æ— æ³•å¤åˆ¶å—ï¼Ÿåœ¨edgeæµè§ˆå™¨ä¸­ç¡®å®æ— æ³•å¤åˆ¶ï¼ˆåæ¥æˆ‘å‘ç°åªæœ‰edgeæµè§ˆå™¨å®ç°äº†è¿™æ ·çš„é™åˆ¶ï¼Œåœ¨chromeå’ŒFirefoxä¸­éƒ½æ²¡æœ‰é™åˆ¶å¤åˆ¶ï¼‰ï¼Œæˆ‘æ‰¾äº†ä¸€ä¸ªå¯ä»¥è§£é”çš„ç½‘ç«™ç»™è¿™ä¸ªpdfè§£é”è¯•è¯•çœ‹ï¼Œè¿™æ—¶å€™å‘ç°æ–‡ä»¶ä¸‹é¢é‚£ä¸ªé«˜åº¦æ€€ç–‘æ˜¯flagçš„é‚£æ®µæ–‡å­—æ— æ³•å•ç‹¬å¤åˆ¶å‡ºæ¥ï¼Œå› ä¸ºèƒŒæ™¯æœ‰å…¶ä»–æ–‡å­—å¹²æ‰°å¤åˆ¶ï¼ˆå…¶å®å¯ä»¥ä¸ç”¨é¼ æ ‡é€‰æ‹©è®¿é—®ï¼Œç›´æ¥ctrl+aå…¨é€‰å¤åˆ¶ï¼‰ï¼Œæˆ‘æ¢åˆ°firefoxä¸­ï¼Œå¯ä»¥æ­£å¸¸çš„é€‰æ‹©åˆ°é‚£æ®µå¼‚å¸¸çš„æ–‡å­—è€Œä¸ä¼šå—åˆ°èƒŒæ™¯ä¸‹å…¶ä»–å­—ç¬¦çš„å¹²æ‰°ã€‚ç»“æœå¤åˆ¶å‡ºæ¥çš„æ–‡å­—å¹¶ä¸æ˜¯ï¼Œè¿™åªæ˜¯ç­¾åˆ°é¢˜å‘€ï¼è¦ä¸è¦ä»€ä¹ˆå¼¯å¼¯ç»•å‘€ï¼è¿™é‡Œæˆ‘æ˜¯æŠŠå¤åˆ¶å‡ºæ¥çš„ç²˜è´´åˆ°äº†æµè§ˆå™¨åœ°å€æ ä¸­ï¼Œæ ¼å¼ä¸­æ¢è¡Œè¢«åäº†ã€‚

çœ‹èµ·æ¥æ˜¯è¿™æ ·:`fa{iet_etUGeGmV! lgNc_oMe_@ekae2}`

å…¶å®å¤åˆ¶åˆ°æ–‡æœ¬ç¼–è¾‘å™¨ä¸­åº”è¯¥æ˜¯è¿™æ ·çš„ï¼š
```
fa{iet_etUGeGmV!
lgNc_oMe_@ekae2}
```

è¿™ä¸‹å°±å¾ˆæ¸…æ¥šçš„äº†ï¼Œæˆ‘æ˜¯çœ‹åˆ°äº†æç¤ºï¼šâ€œç¬¬ä¸€å±Š PKU GeekGame [ç­¾åˆ°é¢˜çš„é¢˜è§£](https://github.com/PKU-GeekGame/geekgame-1st/tree/master/writeups/xmcp#%E7%AD%BE%E5%88%B0-signin)å¯¹è§£å‡ºæœ¬é¢˜å¯èƒ½æœ‰å¸®åŠ©â€ï¼Œæˆ‘æ€»ç®—æ˜¯ææ˜ç™½äº†ã€‚

#### [å°åŒ—é—®ç­” Â· æé€Ÿç‰ˆ](https://geekgame.pku.edu.cn/#/game/prob01)

è¿™é“é¢˜å¾ˆæœ‰æ„æ€ï¼Œæ˜¯æˆ‘æœ‰ä¿¡å¿ƒæå®šçš„ä¸€é“é¢˜ã€‚æ€»å…±æœ‰å…«ä¸ªé—®é¢˜ï¼Œæ¯æ¬¡æŠ½å–å…¶ä¸­7ä¸ªé—®é¢˜ï¼Œç­”å¯¹åæ¯é¢˜14åˆ†ï¼Œåœ¨ä¸€å®šæ—¶é—´å†…å®Œæˆå†åŠ 2åˆ†ï¼Œä¹Ÿå°±æ˜¯è¯´7é¢˜å…¨éƒ¨ç­”å¯¹ï¼Œå¹¶ä¸”å¿…é¡»æ˜¯ç”¨è„šæœ¬æ‰èƒ½åœ¨ä¸€å®šçš„æ—¶é—´å†…å®Œæˆçš„å³å¯æ‹¿åˆ°æ»¡åˆ†å³ç¬¬äºŒä¸ªflagã€‚è¿™å…«é“é¢˜æ˜¯ï¼š

```
- æˆ‘åˆšåˆšåœ¨è„‘æµ·ä¸­æƒ³äº†ä¸€ä¸ªä»‹äº 9779562090 åˆ° 9779562360 ä¹‹é—´çš„è´¨æ•°ã€‚çŒœçŒœå®ƒæ˜¯å¤šå°‘ï¼Ÿ
# å…¶ä¸­çš„æ•°å­—æ˜¯åœ¨ä¸€ä¸ªèŒƒå›´å†…å®£ä¼ ï¼Œå°±æ˜¯è¯´æ¯æ¬¡çš„ç­”æ¡ˆæ˜¯ä¸ä¸€æ ·çš„

- æ”¯æŒ WebP å›¾ç‰‡æ ¼å¼çš„æœ€æ—© Firefox ç‰ˆæœ¬æ˜¯å¤šå°‘ï¼Ÿ
> 65
# https://hacks.mozilla.org/2019/01/firefox-65-webp-flexbox-inspector-new-tooling/

- æˆ‘æœ‰ä¸€ä¸ªæœ‹å‹åœ¨ç¾å›½ï¼Œä»–æ— çº¿è·¯ç”±å™¨çš„ MAC åœ°å€æ˜¯ d2:94:35:21:42:43ã€‚è¯·é—®ä»–æ‰€åœ¨åœ°çš„é‚®ç¼–æ˜¯å¤šå°‘ï¼Ÿ
# è¿™ä¸ªï¼Ÿï¼Ÿï¼Ÿæ‰¾ä¸åˆ°å‘€ï¼

- è®¿é—®ç½‘å€ â€œhttp://ctf.ä¸–ç•Œä¸€æµå¤§å­¦.comâ€ æ—¶ï¼Œå‘è¯¥ä¸»æœºå‘é€çš„ HTTP è¯·æ±‚ä¸­ Host è¯·æ±‚å¤´çš„å€¼æ˜¯ä»€ä¹ˆï¼Ÿ
> ctf.xn--4gqwbu44czhc7w9a66k.com
# å¾ˆç®€å•ï¼Œæ‰“å¼€æµè§ˆå™¨è®¿é—®ä¸€ä¸‹çœ‹çœ‹å°±çŸ¥é“äº†

- è§†é¢‘ bilibili.com/video/BV1EV411s7vu ä¹Ÿå¯ä»¥é€šè¿‡ bilibili.com/video/av_____ è®¿é—®ã€‚ä¸‹åˆ’çº¿å†…åº”å¡«ä»€ä¹ˆæ•°å­—ï¼Ÿ
> 418645518
# ç½‘ç»œä¸Šæœ‰å·¥å…· http://www.atoolbox.net/Tool.php?Id=910

- æ¯ä¸ª Android è½¯ä»¶éƒ½æœ‰å”¯ä¸€çš„åŒ…åã€‚åŒ—äº¬å¤§å­¦è¯¾å¤–é”»ç‚¼ä½¿ç”¨çš„æœ€æ–°ç‰ˆ PKU Runner è½¯ä»¶çš„åŒ…åæ˜¯ä»€ä¹ˆï¼Ÿ
> cn.edu.pku.pkurunner
# ä¸‹è½½å¼•ç”¨ï¼Œè§£å‹ï¼ŒæŸ¥çœ‹AndroidManifest.xmlæ–‡ä»¶å–½ã€‚

- åŒ—äº¬å¤§å­¦æŸå®éªŒå®¤æ›¾å¼€å‘äº†ä¸€ä¸ªå« gStore çš„æ•°æ®åº“è½¯ä»¶ã€‚æœ€æ—©æè¿°è¯¥è½¯ä»¶çš„è®ºæ–‡çš„ DOI ç¼–å·æ˜¯å¤šå°‘ï¼Ÿ
> 10.14778/2002974.2002976
# https://repository.hkust.edu.hk/ir/Record/1783.1-71588

- åœ¨ç¬¬ä¸€å±Š PKU GeekGame æ¯”èµ›çš„é¢˜ç›®ã€Šç”µå­æ¸¸æˆæ¦‚è®ºã€‹ä¸­ï¼Œé€šè¿‡ç¬¬ 10 çº§å…³å¡éœ€è¦å¤šå°‘é‡‘é’±ï¼Ÿ
# https://github.com/PKU-GeekGame/geekgame-1st/blob/master/src/pygame/game/server/libtreasure.py#L19
# æ¯æ¬¡ç»™å‡ºçš„ç­‰çº§æ˜¯ä¸ä¸€æ ·çš„ï¼Œä½†æ˜¯æ‰¾åˆ°äº†ä¸Šå±Šæ¯”èµ›çš„æºç ï¼Œå¾ˆæ¸…æ¥šï¼Œæ ¹æ®å…¬å¼è®¡ç®—å³å¯
# 300+int(level**1.5)*100

```

è¿™å…«é“é¢˜ï¼Œå…¶ä¸­æœ‰ä¸€é“æˆ‘åšä¸å‡ºæ¥ï¼Œå‰©ä¸‹çš„7é“é¢˜ä¸­æœ‰ä¸€é“è¯¢é—®è´¨æ•°çš„é¢˜æœ‰ 1/8 çš„å‡ ç‡å›ç­”æ­£ç¡®ï¼Œæ‰€ä»¥ä½ æœ‰ä¸€é“é¢˜ä¸ä¼šï¼Œä»ç„¶æœ‰ 1/72 çš„å‡ ç‡è§£å‡ºé¢˜ç›®ã€‚ğŸ¤£ğŸ˜‚ğŸ˜…

å…ˆçœ‹ä¸€ä¸‹æˆ‘æ€ä¹ˆè§£å†³æ‰¾åˆ°è´¨æ•°çš„é¢˜ç›®å§ï¼Œå‡ºé¢˜äººç»™å‡ºçš„èŒƒå›´æ¯æ¬¡éƒ½ä¸ä¸€æ ·ï¼Œè¿™æ ·æ¯æ¬¡éƒ½è¦é‡æ–°æ‰¾ç­”æ¡ˆï¼Œä¸æƒ³å…¶ä»–çš„é¢˜ç›®å¾—åˆ°ç­”æ¡ˆåæ¯æ¬¡éƒ½æäº¤ä¸€æ ·çš„ã€‚

æˆ‘æ‰¾åˆ°äº†ä¸€ä¸ªå¯ä»¥ä¸‹è½½è´¨æ•°çš„ç½‘ç«™ï¼Œ[http://www.primos.mat.br/indexen.html](http://www.primos.mat.br/indexen.html) å°†éœ€è¦çš„è´¨æ•°ä¸‹è½½ä¸‹æ¥ï¼Œæ¥ä¸‹æ¥åªè¦åœ¨èŒƒå›´å†…æ‰¾åˆ°å³å¯ã€‚

``` python
def read_nums(filename):
    ''' è¯»å–æ–‡ä»¶ä¸­è®²æ‰€æœ‰çš„æ•°å­—å½¢æˆåˆ—è¡¨
    ç´ æ•°æ˜¯æŒ‰ç…§å¤§å°é¡ºåºå·²ç»æ’åºå¥½çš„ã€‚
    '''
    l = []
    with open(filename,'r',encoding='utf-8') as f:
        for line in f:
            l.extend([int(x) for x in line.split()])
    return l

def binary_search(nums, n):
    ''' äºŒåˆ†æŸ¥æ‰¾
    https://www.zhihu.com/question/36132386/answer/530313852
    '''
    first = 0
    last = len(nums)
    while first < last:
        mid = first + (last - first) // 2
        if nums[mid] < n:
            first = mid + 1
        else:
            last = mid
    return first

def get_range(nums, index, end_n):
    '''
    æ‰¾åˆ°ç¬¦åˆèŒƒå›´æ¡ä»¶çš„ç´ æ•°
    '''
    l = [nums[index]]
    while 1:
        index += 1
        n = nums[index]
        if n > end_n:
            break
        else:
            l.append(n)
    return l

def search_nums(nums, start, end):
    """
    è¿”å›ç¬¦åˆæ¡ä»¶çš„8ä¸ªè´¨æ•°
    """
    start_index = binary_search(nums, start)
    return get_range(nums, start_index, end)

def main(start,end):
    nums = read_nums('p.txt')
    return search_nums(nums, start,end)

if __name__ == '__main__':
    print(main(9165693650, 9165693700))
```
æ¥ä¸‹æ¥éœ€è¦ç”¨ç¨‹åºæ¥è‡ªåŠ¨æäº¤ç­”æ¡ˆï¼Œé¢˜ç›®æç¤ºè¯´å¯ä»¥ç”¨ netcat æˆ–è€… pwntools ç­‰å¸¦ socket é€šä¿¡åŠŸèƒ½çš„åº“æ¥è¿æ¥ï¼Œæˆ‘è¯•äº†ä¸€ä¸‹å‘ç°ä¸å¤ªä¼šç”¨ pwntools å·¥å…·ï¼Œçœ‹ç€ä¹Ÿä¸æ˜¯å¾ˆå¤æ‚å°±æ˜¯ç›´æ¥ç”¨ socket åº“æ¥è¿æ¥å§ï¼ŒæœŸé—´è¿˜æ˜¯é‡åˆ°äº†ä¸€ç‚¹å›°éš¾ï¼Œè„šæœ¬ä¹Ÿä¹Ÿå¾—éå¸¸ç›´æ¥ï¼Œè¾¾åˆ°ç›®çš„å°±è¡Œã€‚

``` python
import socket
import time
import re
import random
from prime import read_nums, search_nums

# æ ¹æ®é¢˜ç›®çš„å‰æ˜¯ä¸ªå­—ç¬¦æ¥é€‰æ‹©ç­”æ¡ˆ
ans = {
    "æ”¯æŒ WebP å›¾ç‰‡": '65',
    "è®¿é—®ç½‘å€ â€œhttp": 'ctf.xn--4gqwbu44czhc7w9a66k.com',
    "è§†é¢‘ bilibil": '418645518',
    "æ¯ä¸ª Android": 'cn.edu.pku.pkurunner',
    "åŒ—äº¬å¤§å­¦æŸå®éªŒå®¤æ›¾å¼€": '10.14778/2002974.2002976',
    "åœ¨ç¬¬ä¸€å±Š PKU G": '0',
    "æˆ‘æœ‰ä¸€ä¸ªæœ‹å‹åœ¨ç¾å›½ï¼Œ": lambda:random.choice([20103,20104,20146,20147,20149,20166]),  # è¿™ä¸ªé¢˜ä¸ä¼šå‘€ï¼
    "åœ¨ç¬¬ä¸€å±Š PKU G": lambda level: 300+int(level**1.5)*100
}

# å…ˆæŠŠåé¢çš„è¦ç”¨ç´ æ•°éƒ½è¯»å–æèµ·å‡†å¤‡å¥½ï¼Œè¿™æ ·åªç”¨è¯»ä¸€éã€‚
primes = read_nums('p.txt')
print("read nums ready!")

def range_nums(content):
    """ å¾—åˆ°ç´ æ•°é¢˜çš„èŒƒå›´
    """
    start,end =  list(map(int, re.findall(r'\d{10}', content)))
    return start,end

def wait_until(conn, size=1024):
    """ recv ç›´åˆ°é—®é¢˜å†…å®¹ç»“æŸ
    """
    r = conn.recv(size).decode()
    while r[-2] != '>':
        r += conn.recv(size).decode()
    return r

def main():
    conn = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    conn.settimeout(5)
    conn.connect(('prob01.geekgame.pku.edu.cn',10001))

    # send token
    r = conn.recv(4096).decode()
    print(r)
    s = b'<your token is here!>\n'
    print(s)
    conn.send(s)

    # å¼€å§‹ç­”é¢˜
    r = conn.recv(4096).decode()
    print(r,end='')
    s = 'æ€¥æ€¥æ€¥\n'
    print(s)
    conn.send(s.encode())

    i=0
    while i<7: # æ¯æ¬¡7é“é¢˜ç›®
        r = wait_until(conn)
        print(r, end="")
        # print('repr:',repr(r[-5:]))

        if r.find("è´¨æ•°") == -1:
            index = r.index('é¢˜ï¼š')
            k = r[index+2:index+12]
            s = ans.get(k,'unknow!')
            if type(s) is not str:
                if k.startswith('åœ¨'):
                    # å…³äºç”µå­æ¸¸æˆæ¦‚è®ºçš„é¢˜ç›®
                    level = int(re.findall(r'\d+',r)[-1])
                    print('level', level)
                    s = s(level)
                else:
                    # ä»MACåœ°å€åˆ°é‚®ç¼–çš„é¢˜
                    s = s()
        else:
            # æ˜¯æ‰¾ç´ æ•°çš„é¢˜
            nums = search_nums(primes, *range_nums(r))
            print(nums)
            s =  random.choice(nums)

        conn.send("{}\n".format(s).encode())
        print(s)
        time.sleep(0.1) # é‡è¦ï¼å¦åˆ™ä¼šå½±å“æ•´ä¸ªæµç¨‹æ­£å¸¸çš„å‘é€å’Œæ¥æ”¶ã€‚

        i+=1

    # è¿”å›æœ€åçš„å¾—åˆ†ç»“æœ
    r = conn.recv(1024).decode()
    while r.find('ï¼') == -1:
        r += conn.recv(1024).decode()
    print(r)
    return r


if __name__ == '__main__':
    # åªæœ‰ä¸åœçš„è¯•æ‰èƒ½æˆåŠŸå‘€ï¼
    while 1:
        result = main()
        # if input('y/n: ') != 'y':
        #     print("End.")
        #     break
        if result.find('ä½ å…±è·å¾—äº† 100 åˆ†') != -1:
            print('GOAL!'*10)
            break
        time.sleep(8)  # æœ‰è¿æ¥é¢‘ç‡é™åˆ¶

```
é¢˜åº“å…±æœ‰ 8 é“é¢˜ï¼Œæ¯æ¬¡ä¼šé€‰æ‹©å…¶ä¸­çš„ 7 é“ã€‚å…¶ä¸­è¯¢é—®è´¨æ•°çš„é¢˜æœ‰ 1/8 çš„å‡ ç‡å›ç­”æ­£ç¡®ï¼Œè¢«æŠ½èµ°çš„å‡ ç‡æ˜¯ 2/9ï¼›å…¶ä½™é¢˜ç›®å‡æœ‰ç¡®å®šçš„æ­£ç¡®ç­”æ¡ˆï¼Œè¢«æŠ½èµ°çš„å‡ ç‡æ˜¯ 1/9ã€‚å› æ­¤ï¼Œå¦‚æœä½ æœ‰ä¸€é“é¢˜ä¸ä¼šï¼Œä»ç„¶æœ‰ 1/72 çš„å‡ ç‡è§£å‡ºé¢˜ç›®ã€‚

å½“çœ‹åˆ°ç»“æœçš„æ—¶å€™ï¼Œæ³ªæµæ»¡é¢ï¼ï¼

![å…´å¥‹](https://h.xavierskip.com:42049/i/f47957840d6685618b07d67dd5b7129769992ff18d2bf7cec6602449bf88a26c.jpg)


### [ç¼–åŸè¯‘ç†ä¹ é¢˜è¯¾](https://geekgame.pku.edu.cn/#/game/prob04)

è¿™é¢˜æœ‰ä¸‰ä¸ªflagï¼Œæœ€ç»ˆæœ‰210äººéƒ¨åˆ†é€šè¿‡ï¼Œå…¶å®ä¸éš¾ï¼Œå‰ä¸¤ä¸ªé€šè¿‡æœç´¢å°±èƒ½å®Œæˆï¼Œæ„Ÿè§‰æ˜¯ä¸ªé€åˆ†é¢˜ï¼Œç»“æœåªæœ‰210äººéƒ¨åˆ†é€šè¿‡ï¼Œçœ‹æ¥å‚åŠ PKUçš„æ¯”èµ›ç¡®å®æ²¡æœ‰USTCçš„å¤šå‘€ï¼

##### ç¼–è¯‘å‡ºçš„ç¨‹åºè¶…è¿‡ 8MB
[increase binary executable size](https://stackoverflow.com/questions/43520681/increase-binary-executable-size)

``` c
#include <stdio.h>
#define SIZE 100000000

char dummy[SIZE] = {'a'};

int main(void){
    dummy[SIZE-1] = '\n';
    if(dummy[0] == 'a')printf("Hello world");
    return 0;
}
```

##### è¾“å‡ºçš„æŠ¥é”™ä¿¡æ¯è¶…è¿‡ 2MB
[åªç”¨ 30 è¡Œä»¥å†…ä»£ç ï¼ŒC++ æœ€å¤šå¯ä»¥äº§ç”Ÿå¤šå°‘è¡Œçš„ç¼–è¯‘é”™è¯¯ä¿¡æ¯ï¼Ÿ](https://www.zhihu.com/question/61427323)
`struct x struct z<x(x(x(x(x(x(x(x(x(x(x(x(x(x(x(x(x(x(y,x(y><y*,x(y*w>v<y*,w,x{}`

å…¶å®æˆ‘ä¹Ÿä¸æ‡‚ä¸ºå•¥ï¼Œé¢å¯¹æœç´¢å¼•æ“ç­”é¢˜å‘—ï¼

### [Flag Checker](https://geekgame.pku.edu.cn/#/game/prob15)

ä¸€ä¸ªé€†å‘javaçš„é¢˜ç›®ï¼Œæˆ‘å±…ç„¶è§£å‡ºæ¥äº†ã€‚è¿˜å¥½ä¸æ˜¯é€†å‘Cä¹‹ç±»çš„ï¼Œä¼°è®¡æˆ‘å°±ä¸è¡Œäº†ã€‚

é¢˜ç›®æé†’ï¼šJRE ç‰ˆæœ¬é«˜äº 15 æ—¶å¯èƒ½æ— æ³•è¿è¡Œæ­¤ç¨‹åºã€‚å»ºè®®ä½¿ç”¨ JRE 8 è¿è¡Œã€‚è§£å®Œé¢˜åæ¥çœ‹æ¥å®Œå…¨å¯ä»¥ä¸è¿è¡Œè¿™ä¸ªç¨‹åºï¼Œæ¯•ç«Ÿè¿™ä¸ªç¯å¢ƒä¹Ÿæœ‰ç‚¹è€äº†ã€‚

æˆ‘è¯•äº†å‡ ä¸ªjavaé€†å‘çš„å·¥å…· [JD-GUI](http://java-decompiler.github.io/)ã€[JADX](https://github.com/skylot/jadx)ã€[CFR](http://www.benf.org/other/cfr/)

å‘ç°CFRè¿™ä¸ªå·¥å…·å¥½ç”¨ã€‚ç›´æ¥çš„ç”Ÿæˆæºä»£ç æ–‡ä»¶é‡Œé¢çš„å­—ç¬¦ä¸²ä¸ä¼šé”™ä¹±ã€‚

`java -jar cfr-0.152.jar prob15.jar > GeekGame.java`

å¾ˆæ˜æ˜¾ï¼Œç¬¬ä¸€ä¸ªflagå°±åœ¨è¿™é‡Œï¼Œå…ˆå¯¹flagè¿›è¡Œbase64ç¼–ç å†è¿›è¡Œrot13æ›¿æ¢ï¼Œè¿™ä¸¤ä¸ªéƒ½èƒ½å¾ˆæ–¹ä¾¿çš„é€†å‘æ“ä½œçš„ã€‚

``` java
    byte[] byArray = this.textField1.getText().getBytes("UTF-8");
    String string = GeekGame.rot13(Base64.getEncoder().encodeToString(byArray));
    if ("MzkuM8gmZJ6jZJHgnaMuqy4lMKM4".equals(string)) {
        JOptionPane.showMessageDialog(null, "Correct");
    } else {
        JOptionPane.showMessageDialog(null, "Wrong");
    }
```
è¦æ³¨æ„çš„æ˜¯è¿™é‡Œä½¿ç”¨çš„rot13ä¸æ˜¯æ ‡å‡†çš„rot13è¦ç¨å¾®å¤„ç†ä¸€ä¸‹ã€‚ä¸ç†Ÿæ‚‰javaå¯ä»¥ç”¨åˆ«çš„è¯­è¨€ä»£æ›¿ã€‚

```python
import base64

def rot13(content):
    r = []
    for c in content:
        n = ord(c)
        if n >= ord('a') and n <= ord('m'):
            n += 13
        elif n >= ord('A') and n <= ord('M'):
            n += 13
        elif n >= ord('n') and n <= ord('z'):
            n -= 13
        elif n >= ord('N') and n <= ord('Z'):
            n -= 13
        elif n >= ord('5') and n <= ord('9'):
            n -= 5
        elif n >= ord('0') and n <= ord('4'):
            n += 5
        r.append(chr(n))
    return ''.join(r)
        
if __name__ == '__main__':
    result = base64.b64decode(rot13('MzkuM8gmZJ6jZJHgnaMuqy4lMKM4'))
    print(result)
```

ç¬¬äºŒä¸ªflagï¼Œç›´æ¥æŠŠç›¸å…³éƒ¨åˆ†æŒ–å‡ºæ¥è·‘ä¸€ä¸‹ã€‚

```java
class flag{  
    public static void main(String args[]){
        String string = "\u0089\u009a\u0081...å¤ªé•¿å°±éšå»äº†....\u00b2\u00c6\u0092";
        StringBuilder stringBuilder = new StringBuilder();
        for (int i = 0; i < string.length(); ++i) {
            stringBuilder.append((char)(string.charAt(i) ^ 0xEF));
        }
        System.out.println(stringBuilder.toString());
    }  
}
```
å…¶å®å°±æ˜¯åˆ©ç”¨Javaé‡Œçš„jså¼•æ“è·‘ä¸€æ®µjs

``` javascript
function checkflag2(_0xa83ex2){var _0x724b=['charCodeAt','map','','split','stringify','Correct','Wrong','j-'];return (JSON[_0x724b[4]](_0xa83ex2[_0x724b[3]](_0x724b[2])[_0x724b[1]](function(_0xa83ex3){return _0xa83ex3[_0x724b[0]](0)}))== JSON[_0x724b[4]]([0,15,16,17,30,105,16,31,16,67,3,33,5,60,4,106,6,41,0,1,67,3,16,4,6,33,232][_0x724b[1]](function(_0xa83ex3){return (checkflag2+ _0x724b[2])[_0x724b[0]](_0xa83ex3)}))?_0x724b[5]:_0x724b[6])}
```

ç¨åŠ åˆ†æï¼Œflag2å°±æ˜¯é‚£ä¸ªç”±é‚£ä¸ªåˆ—è¡¨è¡¨ç¤ºçš„æ•°æ®æ„æˆçš„ï¼Œåˆ—è¡¨ä¸­è®°å½•çš„æ˜¯ç»„æˆflagçš„å­—ç¬¦åœ¨ä¸Šé¢è¿™ä¸ªå‡½æ•°ä¸­çš„ä½ç½®ã€‚å…ˆå°†ä¸Šé¢çš„ä»£ç åœ¨æµè§ˆå™¨å¼€å‘å·¥å…·ä¸­è¿è¡Œï¼Œç„¶åå†è¿è¡Œä¸‹é¢çš„ä»£ç 

```javascript
[0,15,16,17,30,105,16,31,16,67,3,33,5,60,4,106,6,41,0,1,67,3,16,4,6,33,232]['map'](function(e){return (checkflag2+ '')['charAt'](e)}).join('')
```


### [ä¼é¹…æ–‡æ¡£](https://geekgame.pku.edu.cn/#/game/prob21)

æœ‰ç‚¹æ„æ€ï¼Œåˆä¸å¤ªéš¾çš„é¢˜ç›®ï¼Œæ˜¯åœ¨ç¬¬äºŒé˜¶æ®µæç¤ºä¸‹åšå‡ºæ¥çš„ã€‚è¿™é“é¢˜æ˜¯åˆ©ç”¨è…¾è®¯æ–‡æ¡£æ¥çš„ï¼Œè‚¯å®šä¸æ˜¯åˆ©ç”¨è…¾è®¯æ–‡æ¡£çš„æ¼æ´äº†ï¼Œæç¤ºæ˜¯ä¸€é“æµé‡åˆ†æé¢˜ï¼Œåº”è¯¥æ˜¯å°±æ˜¯ç”¨æµè§ˆå™¨çš„å·¥å…·åˆ†æhttpè¯·æ±‚ã€‚

é¦–å…ˆæ‰“å¼€æ–‡æ¡£é¡µé¢ï¼Œæ‰“å¼€å¼€å‘è€…å·¥å…·è®°å½•ç½‘ç»œè¯·æ±‚ï¼Œç„¶åå¯ä»¥æœç´¢å•å…ƒæ ¼é‡Œçš„å†…å®¹ï¼Œæ¯”å¦‚"é€šè¿‡ä»¥ä¸‹é“¾æ¥è®¿é—®é¢˜ç›®æœºå¯†flag"å¯ä»¥çœ‹åˆ°ç›¸åº”çš„è¯·æ±‚ï¼Œæ˜¯ä¸€ä¸ª opendoc çš„apiè¯·æ±‚ï¼Œå“åº”é‡Œå°±èƒ½å‘ç°ä¸€äº›ç«¯å€ªï¼Œè¿™äº›æ˜ç™½äº†ï¼Œé“¾æ¥çš„æ•´ä¸ªurlæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸€ä¸ªå•å…ƒæ ¼æ”¾åœ¨æ•´ä¸ªå·¥ä½œè¡¨é‡Œé¢çš„ï¼Œå› ä¸ºæŸç§åŸå› è¢«éšè—äº†ï¼Œä½†æ˜¯åœ¨è¯·æ±‚ä¸­ç›¸åº”çš„å†…å®¹è¢«è¿”å›äº†ï¼Œåªæ˜¯æ²¡æœ‰æ˜¾ç¤ºåœ¨ç•Œé¢ä¸Šã€‚éœ€è¦æ³¨æ„çš„æ˜¯æ•´ä¸ªå·¥ä½œè¡¨çš„å†…å®¹ä¸æ˜¯ä¸€ä¸ªè¯·æ±‚å°±åŒ…æ‹¬äº†çš„ï¼Œä½ å¯ä»¥é€šè¿‡åˆ†åˆ«æœç´¢A1å’ŒA73å•å…ƒæ ¼çš„å†…å®¹è·å–å®Œæ•´çš„å†…å®¹ï¼Œç›´æ¥çœ‹ç›¸åº”å†…å®¹å°±å¯ä»¥å¾—åˆ°é‚£ä¸ªæœºå¯†çš„flagé“¾æ¥äº†ã€‚

æ‰“å¼€é‚£ä¸ªé“¾æ¥ä½ èƒ½å¤Ÿä¸‹è½½åˆ°ä¸€ä¸ªåç¼€åä¸ºharçš„è¯·æ±‚è®°å½•æ–‡ä»¶ï¼Œå¯ä»¥å°†è¿™ä¸ªæ–‡ä»¶ç›´æ¥æ‹–åˆ°æµè§ˆå™¨å¼€å‘è€…å·¥å…·ç½‘ç»œé¡µé¢æ¥æ‰“å¼€ã€‚æ ¹æ®æç¤ºflagå°±è—åœ¨è¿™ä¸ªé¡µé¢é‡Œé¢ï¼Œä½†æ˜¯ä½ æƒ³é€šè¿‡æ‰¾åˆ°è¿™ä¸ªé¡µé¢ï¼Œå‘ç°æ­¤è·¯ä¸é€šçš„ï¼Œè¿™ä¸ªé¡µé¢å·²ç»è¢«åˆ é™¤äº†ã€‚é‚£ä¹ˆæ‰¾åˆ°è¿™ä¸ªflagå°±åªèƒ½æŠŠè¿™ä¸ªé¡µé¢è¿˜åŸå‡ºæ¥ã€‚

è¿™ä¸ªflagæ˜¯åœ¨è¡¨å•é‡Œç”¨ç‚¹é˜µçš„å½¢å¼ç”»å‡ºæ¥çš„ï¼Œæˆ‘å®Œå…¨å¯ä»¥åˆ©ç”¨è¿™äº›jsonä¿¡æ¯æŠŠflagé‡æ–°ç”»å‡ºæ¥ï¼Œç®€å•è§‚å¯Ÿäº†ä¸€ä¸‹è¡¨ç¤ºè…¾è®¯æ–‡æ¡£å•å…ƒæ ¼çš„æ•°æ®æ ¼å¼ï¼Œå»ºäº†ä¸€ä¸ªç©ºç™½è¡¨æ ¼åœ¨é‡Œé¢è¯•äº†ä¸€ä¸‹æ•°æ®æ˜¯å¦‚ä½•è¡¨ç¤ºçš„ï¼Œå‘ç°ç”»å‡ºæ¥ä¸æ˜¯ä¸ªå¤æ‚çš„äº‹æƒ…ï¼Œå†™äº†ä¸ªè„šæœ¬å°±æŠŠflagç”»å‡ºæ¥äº†ï¼

```python
import json

def read_json_file(filename):
    with open(filename,'r') as f:
        json_flag = json.loads(f.read())
    return json_flag

def main():
    json_flag = read_json_file('flag.json')
    # print(json_flag)
    i = 0
    while i<2640:
        # è§‚å¯Ÿåˆ°é‚£ä¸ªè¡¨åˆ—é¡¹æ˜¯Aåˆ°Kæ˜¯11ä¸ªã€‚
        if (i+1) % 11 == 0:
            endchar = '\n'
        else:
            endchar = ''
        c = json_flag.get(str(i), ' ')
        if c == ' ':
            w = ' '
        else:
            w = 'â–‰'
        print(w, end=endchar)
        i += 1

if __name__ == '__main__':
    main()

```
æ„Ÿè§‰æœ‰ç‚¹é…·
![flag](https://h.xavierskip.com:42049/i/1b33d5b56578cac62f3a5538e937da293262353bdce7e3ed994379d451984363.jpg)


å…¶ä»–çš„é¢˜ç›®å¯ä»¥å»çœ‹å®˜æ–¹[writeup](https://github.com/PKU-GeekGame/geekgame-2nd/tree/master/problemset)ã€‚